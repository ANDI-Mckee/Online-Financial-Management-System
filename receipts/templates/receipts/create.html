{% extends 'apps_base.html' %}

{% block title %}Create receipt{% endblock %}

{% block apps_base_stylesheets %}
    <style>
        #create-receipt-btn {
            max-width: 330px;
            margin: 0 auto;
        }

        .create-receipt-header {
            font-family: Dosis, sans-serif;
            font-size: 1.4em;
            margin-bottom: 1em;
        }
    </style>
{% endblock %}

{% block apps_base_title %}Create a new receipt{% endblock %}

{% block apps_base_content %}
    <form action="{% url 'create_receipt' %}" method="post">
        {% csrf_token %}
        <header class="create-receipt-header text-muted">Receipt Information</header>
        <div class="container row">
            <div class="form-group col-md-6">
                <label for="payer-name">Payer</label>
                <input id="payer-name" class="form-control" type="text" name="payer" maxlength="30" required/>
            </div>
            <div class="form-group col-md-6">
                <label for="payee-name">Payee</label>
                <input id="payee-name" class="form-control" type="text" name="payee" maxlength="30" required/>
            </div>
            <div class="form-group col-md-6">
                <label for="address">Address</label>
                <input id="address" class="form-control" type="text" name="address" maxlength="80" required/>
            </div>
            <div class="form-group col-md-6">
                <label for="date">Date</label>
                <input id="date" class="form-control" type="date" name="date" required/>
            </div>
            <div class="form-group col-md-12" style="margin: 0 auto">
                <label for="notes">Notes</label>
                <input id="notes" class="form-control" type="text" name="notes" maxlength="80"/>
            </div>
        </div>
        <header class="create-receipt-header mt-3 text-muted">Items in Receipt</header>
        <div class="item-form row">
            <div class="form-group col-md-4">
                <label for="name-0">Item Name</label>
                <input id="name-0" name="item-0" type="text" class="form-control" maxlength="10" required>
            </div>
            <div class="form-group col-md-4">
                <label for="spec-0">Spec</label>
                <input id="spec-0" name="spec-0" type="text" class="form-control" maxlength="10" required>
            </div>
            <div class="form-group col-md-4">
                <label for="number-0">Number</label>
                <input id="number-0" name="number-0" type="number" class="form-control" min="1" step="1" required>
            </div>
            <div class="form-group col-md-4">
                <label for="unit-0">Unit</label>
                <input id="unit-0" name="unit-0" type="text" class="form-control" maxlength="10" required>
            </div>
            <div class="form-group col-md-4">
                <label for="price-0">Price</label>
                <input id="price-0" name="price-0" type="number" class="form-control" min="0" step="0.01" required>
            </div>
            <div class="form-group col-md-4">
                <label for="total-cost-0">Total Cost</label>
                <input id="total-cost-0" name="total-cost-0" type="number" class="form-control" min="0" step="0.01"
                       readonly required>
            </div>
        </div>
        <button id="create-receipt-btn" class="btn btn-lg btn-primary btn-block" type="submit">Create</button>
    </form>


{% endblock %}

{% block apps_base_scripts %}
    <script>
        {# Make date auto set to today #}
        Date.prototype.toDateInputValue = (function () {
            var local = new Date(this);
            local.setMinutes(this.getMinutes() - this.getTimezoneOffset());
            return local.toJSON().slice(0, 10);
        });
        $(document).ready(function () {
            $('#date').val(new Date().toDateInputValue());
        });

        {# Auto calculate total cost #}
        var a, b;
        $(document).ready(function () {
            $("#number-0").change(function () {
                a = this.value;
                document.getElementById("total-cost-0").value = a * b;

            });

            $("#price-0").change(function () {
                b = this.value;
                document.getElementById("total-cost-0").value = a * b;

            });
        });
    </script>
{% endblock %}